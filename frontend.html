<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>PhishGuard — Webpage Phishing Detection</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    :root{
      --bg1:#0b1020;
      --bg2:#151a33;
      --accent1:#7c3aed; /* purple */
      --accent2:#06b6d4; /* cyan */
      --accent3:#22c55e; /* green */
      --danger:#ef4444;
      --warning:#f59e0b;
      --muted: rgba(255,255,255,.68);
      --glass: rgba(255,255,255,.08);
      --glass2: rgba(255,255,255,.12);
      --border: rgba(255,255,255,.14);
    }

    /* Background: gradient + glow blobs */
    body{
      min-height:100vh;
      background:
        radial-gradient(900px 500px at 15% 10%, rgba(124,58,237,.30), transparent 60%),
        radial-gradient(900px 500px at 85% 15%, rgba(6,182,212,.26), transparent 60%),
        radial-gradient(800px 600px at 70% 85%, rgba(34,197,94,.18), transparent 60%),
        linear-gradient(180deg, var(--bg1), var(--bg2));
      color:#fff;
      overflow-x:hidden;
    }

    .brand {
      letter-spacing: .4px;
      font-weight: 800;
    }

    .subtle {
      color: var(--muted);
    }

    .glass-card{
      background: linear-gradient(180deg, var(--glass), rgba(255,255,255,.05));
      border: 1px solid var(--border);
      border-radius: 18px;
      box-shadow:
        0 20px 60px rgba(0,0,0,.45),
        inset 0 1px 0 rgba(255,255,255,.08);
      backdrop-filter: blur(10px);
    }

    .hero-badge{
      display:inline-flex;
      align-items:center;
      gap:.5rem;
      padding:.35rem .7rem;
      border: 1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.06);
      border-radius: 999px;
      font-size: .85rem;
      color: rgba(255,255,255,.78);
    }

    .hero-title{
      font-size: clamp(1.8rem, 3vw, 2.3rem);
      line-height: 1.15;
      margin-top: .9rem;
      margin-bottom: .4rem;
      font-weight: 800;
    }

    .gradient-text{
      background: linear-gradient(90deg, #a78bfa, #22d3ee, #34d399);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }

    .input-glow{
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.18);
      color: #fff;
      border-radius: 12px;
      padding: .85rem .95rem;
    }

    .input-glow:focus{
      box-shadow: 0 0 0 .25rem rgba(124,58,237,.22);
      border-color: rgba(124,58,237,.55);
      background: rgba(255,255,255,.08);
      color:#fff;
    }

    .btn-neon{
      border-radius: 12px;
      font-weight: 700;
      padding: .85rem 1rem;
      background: linear-gradient(90deg, var(--accent1), var(--accent2));
      border: 0;
      box-shadow: 0 14px 30px rgba(124,58,237,.25);
      transition: transform .12s ease, box-shadow .12s ease, filter .12s ease;
    }
    .btn-neon:hover{
      transform: translateY(-1px);
      box-shadow: 0 18px 40px rgba(6,182,212,.20), 0 12px 28px rgba(124,58,237,.24);
      filter: brightness(1.04);
    }
    .btn-neon:disabled{
      opacity: .75;
      cursor: not-allowed;
    }

    .pill{
      border-radius: 999px;
      padding: .35rem .7rem;
      font-weight: 700;
      font-size: .85rem;
      border: 1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.06);
      display:inline-flex;
      align-items:center;
      gap:.45rem;
    }

    .pill.low { box-shadow: 0 0 0 1px rgba(34,197,94,.18) inset; }
    .pill.med { box-shadow: 0 0 0 1px rgba(245,158,11,.18) inset; }
    .pill.high{ box-shadow: 0 0 0 1px rgba(239,68,68,.18) inset; }

    .progress{
      height: 12px;
      border-radius: 999px;
      background: rgba(255,255,255,.10);
      overflow:hidden;
    }
    .progress-bar{
      transition: width .6s ease;
      border-radius: 999px;
    }

    .fineprint{
      color: rgba(255,255,255,.55);
      font-size: .9rem;
    }

    .mono{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
    }

    details summary{
      cursor: pointer;
      color: rgba(255,255,255,.72);
    }
    details summary:hover{ color: rgba(255,255,255,.9); }

    .kbd{
      border: 1px solid rgba(255,255,255,.18);
      background: rgba(255,255,255,.07);
      border-radius: 8px;
      padding: .05rem .35rem;
      font-size: .85rem;
    }

    /* small feature cards */
    .mini-card{
      background: rgba(255,255,255,.05);
      border: 1px solid rgba(255,255,255,.12);
      border-radius: 14px;
      padding: .85rem .9rem;
      height: 100%;
    }
  </style>
</head>

<body>
  <div class="container py-5">
    <div class="row justify-content-center">
      <div class="col-lg-9 col-xl-8">

        <!-- Header -->
        <div class="d-flex justify-content-between align-items-center mb-4">
          <div class="brand">
            <span class="gradient-text">PhishGuard</span>
            <span class="subtle fw-semibold">| BERT Content Detector</span>
          </div>
          <div class="hero-badge">
            <span class="mono">CPU</span>
            <span class="mx-1">•</span>
            <span>Local Demo</span>
          </div>
        </div>

        <!-- Hero -->
        <div class="glass-card p-4 p-md-5">
          <div class="row g-4 align-items-center">
            <div class="col-md-7">
              <div class="hero-badge">
                <span>Real-time analysis</span>
                <span class="mx-1">•</span>
                <span>Webpage text</span>
                <span class="mx-1">•</span>
                <span class="mono">/predict_page</span>
              </div>

              <h1 class="hero-title">
                Detect phishing pages with
                <span class="gradient-text">fine-tuned BERT</span>
              </h1>

              <p class="subtle mb-0">
                Paste a URL. We fetch the page content, extract visible text, and return a phishing probability score.
                Designed for fast demos, clear results, and reproducible evaluation.
              </p>
            </div>

            <div class="col-md-5">
              <div class="mini-card">
                <div class="fw-bold mb-2">Tips for better signal</div>
                <div class="fineprint">
                  • Use full URL with <span class="kbd">https://</span><br>
                  • Pages with lots of scripts may be sparse<br>
                  • We cap text length for speed (demo-friendly)
                </div>
              </div>
            </div>
          </div>

          <hr class="my-4" style="border-color: rgba(255,255,255,.12)">

          <!-- Input -->
          <div class="row g-3 align-items-end">
            <div class="col-md-9">
              <label class="form-label subtle mb-2">Website URL</label>
              <input id="url" class="form-control input-glow" placeholder="https://example.com">
            </div>
            <div class="col-md-3 d-grid">
              <button id="btn" class="btn btn-neon">
                Run Detection
              </button>
            </div>
          </div>

          <!-- Loading -->
          <div id="loading" class="text-center mt-4 d-none">
            <div class="spinner-border" role="status" aria-hidden="true"></div>
            <div class="mt-2 subtle">Analyzing content…</div>
            <div class="fineprint mt-1">Fetching page, cleaning text, tokenizing, running inference.</div>
          </div>

          <!-- Result -->
          <div id="result" class="mt-4 d-none">
            <div class="d-flex flex-wrap justify-content-between align-items-center gap-2 mb-2">
              <div class="fw-bold">Detection Result</div>
              <div id="riskPill" class="pill low">Low Risk</div>
            </div>

            <div class="subtle mb-2">
              Phishing Probability:
              <span id="probText" class="fw-bold"></span>
              <span class="fineprint">(higher means more likely phishing)</span>
            </div>

            <div class="progress mb-2">
              <div id="probBar" class="progress-bar" style="width:0%"></div>
            </div>

            <div class="fineprint mb-3">
              <span class="mono">max_chars</span>: <span id="maxChars"></span> |
              <span class="mono">max_length</span>: <span id="maxLen"></span> |
              <span class="mono">text_len</span>: <span id="textLen"></span>
            </div>

            <details>
              <summary>Show technical details (JSON)</summary>
              <pre id="rawJson" class="mt-2 p-3 rounded mono" style="background: rgba(0,0,0,.35); border: 1px solid rgba(255,255,255,.10);"></pre>
            </details>
          </div>

          <!-- Footer note -->
          <div class="mt-4 fineprint">
            Note: This demo runs locally on CPU. For deployment, the same backend can be hosted on a public server.
          </div>
        </div>

        <div class="text-center mt-4 fineprint">
          Built with Flask + Transformers. Frontend styled with Bootstrap + custom neon glass UI.
        </div>

      </div>
    </div>
  </div>

<script>
  const API = "http://127.0.0.1:5000/predict_page";

  function setRiskUI(prob) {
    const pill = document.getElementById("riskPill");
    const bar = document.getElementById("probBar");

    // Thresholds can be tuned; these are demo-friendly defaults.
    let label = "Low Risk";
    let pillClass = "pill low";
    let barClass = "progress-bar bg-success";

    if (prob >= 0.6) {
      label = "High Risk";
      pillClass = "pill high";
      barClass = "progress-bar bg-danger";
    } else if (prob >= 0.2) {
      label = "Medium Risk";
      pillClass = "pill med";
      barClass = "progress-bar bg-warning";
    }

    pill.className = pillClass;
    pill.textContent = label;

    bar.className = barClass;
  }

  async function runDetection() {
    const url = document.getElementById("url").value.trim();
    if (!url) return;

    const btn = document.getElementById("btn");
    btn.disabled = true;

    document.getElementById("result").classList.add("d-none");
    document.getElementById("loading").classList.remove("d-none");

    try {
      const resp = await fetch(API, {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({ url, max_chars: 4000, max_length: 256 })
      });

      const data = await resp.json();
      if (!resp.ok) throw new Error(data.error || "Request failed");

      const prob = data.phishing_prob;
      const percent = (prob * 100).toFixed(2);

      document.getElementById("probText").textContent = `${percent}%`;
      document.getElementById("probBar").style.width = `${percent}%`;

      setRiskUI(prob);

      document.getElementById("maxChars").textContent = data.max_chars;
      document.getElementById("maxLen").textContent = data.max_length;
      document.getElementById("textLen").textContent = data.text_len;

      document.getElementById("rawJson").textContent = JSON.stringify(data, null, 2);

      document.getElementById("loading").classList.add("d-none");
      document.getElementById("result").classList.remove("d-none");

    } catch (e) {
      alert("Error: " + e.message);
      document.getElementById("loading").classList.add("d-none");
    } finally {
      btn.disabled = false;
    }
  }

  document.getElementById("btn").addEventListener("click", runDetection);

  // UX: press Enter to run
  document.getElementById("url").addEventListener("keydown", (e) => {
    if (e.key === "Enter") runDetection();
  });
</script>

</body>
</html>
